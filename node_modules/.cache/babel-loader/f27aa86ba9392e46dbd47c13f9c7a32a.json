{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\tarus\\\\Documents\\\\Marketplace-ReactJS-Project\\\\client\\\\src\\\\Pages\\\\Edit.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect } from 'react';\nimport { Col, Form, Button, Spinner, Alert } from 'react-bootstrap';\nimport SimpleSider from '../components/Siders/SimpleSider';\nimport { getSpecific, editProduct } from '../services/productData';\nimport '../components/Edit/Edit.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Edit({\n  match,\n  history\n}) {\n  _s();\n\n  const [product, setProduct] = useState({});\n  const [loading, setLoading] = useState(false);\n  const [alertShow, setAlertShow] = useState(false);\n  const [error, setError] = useState(null);\n  const productId = match.params.id;\n  useEffect(() => {\n    window.scrollTo(0, 0);\n    getSpecific(productId).then(res => setProduct(res)).catch(err => console.log(err));\n  }, [productId]);\n\n  const onChangeHandler = e => {\n    e.preventDefault();\n    setProduct({ ...product,\n      [e.target.name]: e.target.value\n    });\n\n    if (e.target.files) {\n      setProduct({ ...product,\n        image: e.target.files[0]\n      });\n    }\n  };\n\n  const onSubmitHandler = e => {\n    //TODO: Rewrite this \n    e.preventDefault();\n    let {\n      _id,\n      title,\n      price,\n      description,\n      city,\n      category,\n      image\n    } = product;\n    let obj = {\n      title,\n      price,\n      description,\n      city,\n      category\n    };\n    setLoading(true);\n\n    if (typeof image == 'object') {\n      getBase64(image).then(data => {\n        obj['image'] = data;\n        editProduct(_id, obj).then(res => {\n          if (!res.error) {\n            history.push(`/categories/${category}/${_id}/details`);\n          } else {\n            setLoading(false);\n            setError(res.error);\n            setAlertShow(true);\n          }\n        }).catch(err => console.error('edit product err: ', err));\n      }).catch(err => console.log('base64 error: ', err));\n    } else {\n      editProduct(_id, obj).then(res => {\n        if (!res.error) {\n          history.push(`/categories/${category}/${_id}/details`);\n        } else {\n          setLoading(false);\n          setError(res.error);\n          setAlertShow(true);\n        }\n      }).catch(err => console.error('edit product err: ', err));\n    }\n  };\n\n  function getBase64(file) {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onload = () => resolve(reader.result);\n\n      reader.onerror = error => reject(error);\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(SimpleSider, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"heading\",\n        children: \"Edit product\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        onSubmit: onSubmitHandler,\n        children: [alertShow && /*#__PURE__*/_jsxDEV(Alert, {\n          variant: \"danger\",\n          onClose: () => setAlertShow(false),\n          dismissible: true,\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Form.Row, {\n          children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n            as: Col,\n            controlId: \"formGridTitle\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Title\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 92,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n              type: \"text\",\n              placeholder: \"Enter title\",\n              name: \"title\",\n              value: product.title,\n              onChange: onChangeHandler,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            as: Col,\n            controlId: \"formGridPrice\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Price\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n              type: \"number\",\n              step: \"0.01\",\n              placeholder: \"Price\",\n              name: \"price\",\n              value: product.price,\n              onChange: onChangeHandler,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n          controlId: \"formGridDescription.ControlTextarea1\",\n          children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n            children: \"Description\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n            as: \"textarea\",\n            rows: 3,\n            name: \"description\",\n            defaultValue: product.description,\n            onChange: onChangeHandler,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Row, {\n          children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n            as: Col,\n            controlId: \"formGridCity\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"City\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n              name: \"city\",\n              placeholder: \"Sofia\",\n              value: product.city,\n              onChange: onChangeHandler,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 110,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            as: Col,\n            controlId: \"formGridCategory\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Category\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n              as: \"select\",\n              value: product.category,\n              name: \"category\",\n              onChange: onChangeHandler,\n              required: true,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"Choose...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 116,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"properties\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 117,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"auto\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"electronics\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"clothes\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 120,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"toys\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 121,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"home\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                children: \"garden\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 123,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n            as: Col,\n            controlId: \"formGridImage\",\n            children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n              children: \"Image\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n              name: \"image\",\n              type: \"file\",\n              onChange: onChangeHandler\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 21\n        }, this), loading ? /*#__PURE__*/_jsxDEV(Button, {\n          className: \"col-lg-12\",\n          variant: \"dark\",\n          disabled: true,\n          children: [\"Please wait... \", /*#__PURE__*/_jsxDEV(Spinner, {\n            animation: \"border\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 44\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(Button, {\n          className: \"col-lg-12\",\n          variant: \"dark\",\n          type: \"submit\",\n          children: \"Add product\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Edit, \"yaRSSLypAxr+ijOB9JWlMSdBr8c=\");\n\n_c = Edit;\nexport default Edit;\n\nvar _c;\n\n$RefreshReg$(_c, \"Edit\");","map":{"version":3,"sources":["C:/Users/tarus/Documents/Marketplace-ReactJS-Project/client/src/Pages/Edit.js"],"names":["useState","useEffect","Col","Form","Button","Spinner","Alert","SimpleSider","getSpecific","editProduct","Edit","match","history","product","setProduct","loading","setLoading","alertShow","setAlertShow","error","setError","productId","params","id","window","scrollTo","then","res","catch","err","console","log","onChangeHandler","e","preventDefault","target","name","value","files","image","onSubmitHandler","_id","title","price","description","city","category","obj","getBase64","data","push","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { Col, Form, Button, Spinner, Alert } from 'react-bootstrap';\r\nimport SimpleSider from '../components/Siders/SimpleSider';\r\nimport { getSpecific, editProduct } from '../services/productData';\r\n\r\nimport '../components/Edit/Edit.css'\r\n\r\nfunction Edit({ match, history }) {\r\n    const [product, setProduct] = useState({});\r\n    const [loading, setLoading] = useState(false);\r\n    const [alertShow, setAlertShow] = useState(false);\r\n    const [error, setError] = useState(null);\r\n    const productId = match.params.id;\r\n\r\n    useEffect(() => {\r\n        window.scrollTo(0, 0);\r\n        getSpecific(productId)\r\n            .then(res => setProduct(res))\r\n            .catch(err => console.log(err));\r\n    }, [productId])\r\n\r\n    const onChangeHandler = (e) => {\r\n        e.preventDefault();\r\n        setProduct({ ...product, [e.target.name]: e.target.value });\r\n        if (e.target.files) {\r\n            setProduct({ ...product, image: e.target.files[0] })\r\n        }\r\n    }\r\n\r\n    const onSubmitHandler = (e) => {\r\n        //TODO: Rewrite this \r\n        e.preventDefault();\r\n        let { _id, title, price, description, city, category, image } = product;\r\n        let obj = { title, price, description, city, category }\r\n        setLoading(true);\r\n        if (typeof image == 'object') {\r\n            getBase64(image)\r\n                .then((data) => {\r\n                    obj['image'] = data;\r\n                    editProduct(_id, obj)\r\n                        .then(res => {\r\n                            if (!res.error) {\r\n                                history.push(`/categories/${category}/${_id}/details`)\r\n                            } else {\r\n                                setLoading(false);\r\n                                setError(res.error);\r\n                                setAlertShow(true);\r\n                            }\r\n                        })\r\n                        .catch(err => console.error('edit product err: ', err))\r\n                })\r\n                .catch(err => console.log('base64 error: ', err));\r\n        } else {\r\n            editProduct(_id, obj)\r\n                .then(res => {\r\n                    if (!res.error) {\r\n                        history.push(`/categories/${category}/${_id}/details`)\r\n                    } else {\r\n                        setLoading(false);\r\n                        setError(res.error);\r\n                        setAlertShow(true);\r\n                    }\r\n                })\r\n                .catch(err => console.error('edit product err: ', err))\r\n        }\r\n    }\r\n\r\n    function getBase64(file) {\r\n        return new Promise((resolve, reject) => {\r\n            const reader = new FileReader();\r\n            reader.readAsDataURL(file);\r\n            reader.onload = () => resolve(reader.result);\r\n            reader.onerror = error => reject(error);\r\n        });\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <SimpleSider />\r\n            <div className='container'>\r\n                <h1 className=\"heading\">Edit product</h1>\r\n                <Form onSubmit={onSubmitHandler}>\r\n                    {alertShow &&\r\n                        <Alert variant=\"danger\" onClose={() => setAlertShow(false)} dismissible>\r\n                            <p>\r\n                                {error}\r\n                            </p>\r\n                        </Alert>\r\n                    }\r\n                    <Form.Row>\r\n                        <Form.Group as={Col} controlId=\"formGridTitle\">\r\n                            <Form.Label>Title</Form.Label>\r\n                            <Form.Control type=\"text\" placeholder=\"Enter title\" name=\"title\" value={product.title} onChange={onChangeHandler} required />\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Col} controlId=\"formGridPrice\">\r\n                            <Form.Label>Price</Form.Label>\r\n                            <Form.Control type=\"number\" step=\"0.01\" placeholder=\"Price\" name=\"price\" value={product.price} onChange={onChangeHandler} required />\r\n                        </Form.Group>\r\n                    </Form.Row>\r\n\r\n                    <Form.Group controlId=\"formGridDescription.ControlTextarea1\">\r\n                        <Form.Label>Description</Form.Label>\r\n                        <Form.Control as=\"textarea\" rows={3} name=\"description\" defaultValue={product.description} onChange={onChangeHandler} required />\r\n                    </Form.Group>\r\n\r\n                    <Form.Row>\r\n                        <Form.Group as={Col} controlId=\"formGridCity\">\r\n                            <Form.Label>City</Form.Label>\r\n                            <Form.Control name=\"city\" placeholder=\"Sofia\" value={product.city} onChange={onChangeHandler} required />\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Col} controlId=\"formGridCategory\">\r\n                            <Form.Label>Category</Form.Label>\r\n                            <Form.Control as=\"select\" value={product.category} name=\"category\" onChange={onChangeHandler} required >\r\n                                <option>Choose...</option>\r\n                                <option>properties</option>\r\n                                <option>auto</option>\r\n                                <option>electronics</option>\r\n                                <option>clothes</option>\r\n                                <option>toys</option>\r\n                                <option>home</option>\r\n                                <option>garden</option>\r\n                            </Form.Control>\r\n                        </Form.Group>\r\n\r\n                        <Form.Group as={Col} controlId=\"formGridImage\" >\r\n                            <Form.Label>Image</Form.Label>\r\n                            <Form.Control name=\"image\" type=\"file\" onChange={onChangeHandler} />\r\n                        </Form.Group>\r\n                    </Form.Row>\r\n                    {loading ?\r\n                        <Button className=\"col-lg-12\" variant=\"dark\" disabled >\r\n                            Please wait... <Spinner animation=\"border\" />\r\n                        </Button>\r\n                        :\r\n                        <Button className=\"col-lg-12\" variant=\"dark\" type=\"submit\">Add product</Button>\r\n                    }\r\n                </Form>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Edit;"]},"metadata":{},"sourceType":"module"}